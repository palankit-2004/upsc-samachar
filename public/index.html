<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <!-- â•â•â• PRIMARY SEO â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <title>UPSC Samachar â€” Daily Current Affairs from PIB, The Hindu, Indian Express & Economic Times</title>
  <meta name="description" content="UPSC Samachar aggregates today's most important current affairs from PIB, The Hindu, Indian Express and Economic Times â€” classified by Polity, Economy, Environment, Science, International Relations, Defence and more. Free daily news for IAS, IPS, IFS aspirants." />
  <meta name="keywords" content="UPSC current affairs, IAS preparation, daily news for UPSC, PIB press release, The Hindu editorial, Indian Express explained, Economic Times economy, UPSC 2025, UPSC 2026, polity governance, economy budget RBI, environment ecology, science technology ISRO, international relations, defence security, UPSC mains, UPSC prelims, civil services India" />
  <meta name="author" content="UPSC Samachar" />
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="googlebot" content="index, follow" />
  <link rel="canonical" href="https://upsc-samachar.netlify.app/" />

  <!-- â•â•â• OPEN GRAPH (Facebook / WhatsApp / LinkedIn) â•â•â•â•â•â•â•â•â•â• -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="UPSC Samachar" />
  <meta property="og:title" content="UPSC Samachar â€” Daily Current Affairs for IAS Aspirants" />
  <meta property="og:description" content="All UPSC-relevant news in one place. PIB press releases, The Hindu, Indian Express & Economic Times â€” auto-refreshed, classified by GS topics. Free for all aspirants." />
  <meta property="og:url" content="https://upsc-samachar.netlify.app/" />
  <meta property="og:image" content="https://upsc-samachar.netlify.app/og-image.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="UPSC Samachar â€” Daily Current Affairs Aggregator" />
  <meta property="og:locale" content="en_IN" />

  <!-- â•â•â• TWITTER CARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@UPSCSamachar" />
  <meta name="twitter:title" content="UPSC Samachar â€” Daily Current Affairs for IAS Aspirants" />
  <meta name="twitter:description" content="PIB + The Hindu + Indian Express + Economic Times in one place. Auto-classified by GS topics. Free daily current affairs." />
  <meta name="twitter:image" content="https://upsc-samachar.netlify.app/og-image.png" />

  <!-- â•â•â• MOBILE / PWA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <meta name="theme-color" content="#080B14" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="UPSC Samachar" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="application-name" content="UPSC Samachar" />
  <meta name="format-detection" content="telephone=no" />

  <!-- â•â•â• STRUCTURED DATA (JSON-LD) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "WebSite",
        "@id": "https://upsc-samachar.netlify.app/#website",
        "url": "https://upsc-samachar.netlify.app/",
        "name": "UPSC Samachar",
        "description": "Daily current affairs aggregator for UPSC aspirants â€” PIB, The Hindu, Indian Express, Economic Times",
        "inLanguage": "en-IN",
        "potentialAction": {
          "@type": "SearchAction",
          "target": { "@type": "EntryPoint", "urlTemplate": "https://upsc-samachar.netlify.app/?q={search_term_string}" },
          "query-input": "required name=search_term_string"
        }
      },
      {
        "@type": "NewsMediaOrganization",
        "@id": "https://upsc-samachar.netlify.app/#organization",
        "name": "UPSC Samachar",
        "url": "https://upsc-samachar.netlify.app/",
        "logo": { "@type": "ImageObject", "url": "https://upsc-samachar.netlify.app/icon-192.png" },
        "description": "Curated daily current affairs for UPSC Civil Services aspirants",
        "knowsAbout": ["UPSC Civil Services", "IAS Preparation", "Current Affairs India", "Indian Government Policy"]
      },
      {
        "@type": "WebPage",
        "@id": "https://upsc-samachar.netlify.app/#webpage",
        "url": "https://upsc-samachar.netlify.app/",
        "name": "UPSC Samachar â€” Daily Current Affairs",
        "isPartOf": { "@id": "https://upsc-samachar.netlify.app/#website" },
        "about": { "@id": "https://upsc-samachar.netlify.app/#organization" },
        "description": "Aggregated UPSC-relevant news from PIB, The Hindu, Indian Express and Economic Times, classified by GS topics",
        "inLanguage": "en-IN",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [{ "@type": "ListItem", "position": 1, "name": "Home", "item": "https://upsc-samachar.netlify.app/" }]
        }
      }
    ]
  }
  </script>

  <!-- â•â•â• FAVICON / ICONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“œ</text></svg>" />
  <link rel="apple-touch-icon" href="/icon-192.png" />

  <!-- â•â•â• PRECONNECT / DNS PREFETCH â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="dns-prefetch" href="https://www.pib.gov.in" />
  <link rel="dns-prefetch" href="https://www.thehindu.com" />
  <link rel="dns-prefetch" href="https://indianexpress.com" />
  <link rel="dns-prefetch" href="https://economictimes.indiatimes.com" />

  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&family=IBM+Plex+Sans:wght@300;400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet" />

  <style>
    /* â”€â”€â”€ DESIGN TOKENS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    :root {
      --bg:       #080B14;
      --bg1:      #0D1120;
      --bg2:      #131826;
      --bg3:      #1A2035;
      --surface:  #1E2640;
      --border:   rgba(255,255,255,0.07);
      --border2:  rgba(255,255,255,0.12);
      --text:     #E8ECF4;
      --text2:    #9BA8C0;
      --text3:    #5A6480;
      --gold:     #C9A84C;
      --gold2:    #E8C76B;
      --accent:   #4A7CFF;
      --red:      #E05252;
      --green:    #3DB87A;
      --orange:   #F48C42;
      --pib:      #F97316;
      --hindu:    #DC2626;
      --ie:       #3B82F6;
      --et:       #10B981;
      --radius:   8px;
      --radius-lg:14px;
      --shadow:   0 4px 24px rgba(0,0,0,0.4);
      --shadow-lg:0 8px 48px rgba(0,0,0,0.6);
      --font-display: 'Cormorant Garamond', Georgia, serif;
      --font-body:    'IBM Plex Sans', system-ui, sans-serif;
      --font-mono:    'IBM Plex Mono', monospace;
      /* Mobile safe area */
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-top:    env(safe-area-inset-top, 0px);
    }

    /* â”€â”€â”€ RESET & BASE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; font-size: 16px; -webkit-text-size-adjust: 100%; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-body);
      min-height: 100vh;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    a { color: inherit; text-decoration: none; }
    button { cursor: pointer; border: none; background: none; color: inherit; font: inherit; -webkit-tap-highlight-color: transparent; }
    img { display: block; max-width: 100%; height: auto; }
    ul { list-style: none; }
    /* Prevent font scaling on iOS */
    input, button, select, textarea { font-size: 16px; }

    /* â”€â”€â”€ NOISE OVERLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    body::before {
      content: '';
      position: fixed; inset: 0; z-index: 0; pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
      background-size: 128px 128px; opacity: 0.4;
    }

    /* â”€â”€â”€ ANIMATED BG ORBS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .bg-orbs { position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden; }
    .bg-orbs span {
      position: absolute; border-radius: 50%;
      filter: blur(80px); opacity: 0.06; animation: orbFloat 20s infinite ease-in-out;
    }
    .bg-orbs span:nth-child(1) { width: 600px; height: 600px; background: #4A7CFF; top: -200px; left: -200px; animation-delay: 0s; }
    .bg-orbs span:nth-child(2) { width: 400px; height: 400px; background: #C9A84C; top: 40%; right: -100px; animation-delay: -7s; }
    .bg-orbs span:nth-child(3) { width: 300px; height: 300px; background: #3DB87A; bottom: -100px; left: 30%; animation-delay: -14s; }
    @keyframes orbFloat {
      0%, 100% { transform: translate(0, 0) scale(1); }
      33%  { transform: translate(30px, -20px) scale(1.05); }
      66%  { transform: translate(-20px, 30px) scale(0.95); }
    }
    @media (prefers-reduced-motion: reduce) {
      .bg-orbs span, .ticker-track, .card, .list-item { animation: none !important; }
    }

    /* â”€â”€â”€ LAYOUT WRAPPER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .wrapper { position: relative; z-index: 1; max-width: 1440px; margin: 0 auto; padding: 0 24px; }

    /* â”€â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    header {
      position: sticky; top: 0; z-index: 100;
      background: rgba(8,11,20,0.95);
      backdrop-filter: blur(20px) saturate(1.5);
      -webkit-backdrop-filter: blur(20px) saturate(1.5);
      border-bottom: 1px solid var(--border);
    }
    .header-inner {
      display: flex; align-items: center; gap: 12px;
      padding: 10px 16px; max-width: 1440px; margin: 0 auto;
      min-height: 56px;
    }
    .logo { display: flex; align-items: center; gap: 10px; flex-shrink: 0; text-decoration: none; }
    .logo-icon {
      width: 34px; height: 34px; border-radius: 8px; flex-shrink: 0;
      background: linear-gradient(135deg, var(--gold) 0%, #8B6914 100%);
      display: flex; align-items: center; justify-content: center; font-size: 17px;
    }
    .logo-text { display: flex; flex-direction: column; line-height: 1; }
    .logo-title {
      font-family: var(--font-display); font-size: 1.2rem; font-weight: 700;
      color: var(--gold2); letter-spacing: 0.02em; white-space: nowrap;
    }
    .logo-sub {
      font-size: 0.58rem; color: var(--text3); letter-spacing: 0.15em;
      text-transform: uppercase; font-weight: 500; margin-top: 2px;
    }

    /* Desktop search in header */
    .header-search { flex: 1; max-width: 400px; position: relative; }
    .header-search input {
      width: 100%; background: var(--bg2); border: 1px solid var(--border2);
      border-radius: 50px; padding: 8px 16px 8px 40px;
      color: var(--text); font-family: var(--font-body); font-size: 0.875rem;
      outline: none; transition: border-color 0.2s, box-shadow 0.2s;
    }
    .header-search input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(74,124,255,0.15); }
    .header-search input::placeholder { color: var(--text3); }
    .search-icon { position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: var(--text3); pointer-events: none; }

    .header-actions { display: flex; align-items: center; gap: 6px; margin-left: auto; }

    .btn-icon {
      width: 38px; height: 38px; border-radius: 50%;
      background: var(--bg2); border: 1px solid var(--border);
      display: flex; align-items: center; justify-content: center;
      font-size: 1rem; transition: all 0.2s; position: relative;
      color: var(--text2); flex-shrink: 0; touch-action: manipulation;
    }
    .btn-icon:hover { background: var(--bg3); border-color: var(--border2); color: var(--text); }
    .btn-icon.active { background: var(--accent); border-color: var(--accent); color: white; }
    .notif-badge {
      position: absolute; top: 4px; right: 4px;
      width: 8px; height: 8px; border-radius: 50%;
      background: var(--red); border: 2px solid var(--bg);
    }
    .last-update { font-family: var(--font-mono); font-size: 0.65rem; color: var(--text3); display: none; white-space: nowrap; }
    .btn-refresh-text { display: inline; }

    /* Mobile search button â€” shows on mobile */
    .btn-mobile-search { display: none; }

    /* â”€â”€â”€ MOBILE SEARCH OVERLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .mobile-search-overlay {
      display: none; position: fixed; inset: 0; z-index: 300;
      background: rgba(8,11,20,0.98); backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      flex-direction: column; padding: 16px;
      padding-top: calc(16px + var(--safe-top));
    }
    .mobile-search-overlay.open { display: flex; }
    .mobile-search-overlay .search-row {
      display: flex; align-items: center; gap: 10px; margin-bottom: 16px;
    }
    .mobile-search-overlay input {
      flex: 1; background: var(--bg2); border: 1px solid var(--border2);
      border-radius: 50px; padding: 12px 20px 12px 44px;
      color: var(--text); font-family: var(--font-body); font-size: 1rem;
      outline: none; border-color: var(--accent);
    }
    .mobile-search-overlay .cancel-btn {
      color: var(--text2); font-size: 0.9rem; white-space: nowrap; padding: 8px;
    }
    .mobile-search-suggestions {
      font-size: 0.78rem; color: var(--text3); padding: 8px 0;
    }
    .mobile-search-suggestions strong { color: var(--text2); display: block; margin-bottom: 8px; }
    .suggestion-chip {
      display: inline-block; padding: 5px 12px; margin: 3px; border-radius: 50px;
      background: var(--bg2); border: 1px solid var(--border); font-size: 0.75rem;
      color: var(--text2); cursor: pointer;
    }

    /* â”€â”€â”€ TICKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .ticker-bar {
      background: linear-gradient(90deg, var(--bg1), var(--bg2));
      border-bottom: 1px solid var(--border);
      padding: 6px 0; overflow: hidden; display: flex; align-items: center;
    }
    .ticker-label {
      background: var(--gold); color: #000; font-size: 0.62rem; font-weight: 600;
      letter-spacing: 0.1em; text-transform: uppercase;
      padding: 2px 10px; flex-shrink: 0; margin-right: 12px;
      clip-path: polygon(0 0, 100% 0, calc(100% - 8px) 100%, 0 100%); padding-right: 18px;
    }
    .ticker-track {
      display: flex; gap: 0; animation: tickerScroll 60s linear infinite; white-space: nowrap;
    }
    .ticker-bar:hover .ticker-track { animation-play-state: paused; }
    .ticker-item {
      font-size: 0.76rem; color: var(--text2); padding: 0 20px; flex-shrink: 0;
      display: flex; align-items: center; gap: 8px; cursor: pointer; transition: color 0.2s;
    }
    .ticker-item:hover { color: var(--text); }
    .ticker-sep { color: var(--text3); }
    @keyframes tickerScroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

    /* â”€â”€â”€ NAV TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .nav-tabs-container {
      background: var(--bg1); border-bottom: 1px solid var(--border);
      overflow-x: auto; scrollbar-width: none; -webkit-overflow-scrolling: touch;
    }
    .nav-tabs-container::-webkit-scrollbar { display: none; }
    .nav-tabs {
      display: flex; align-items: center;
      padding: 0 16px; max-width: 1440px; margin: 0 auto; min-width: max-content;
    }
    .nav-tab {
      padding: 12px 14px; font-size: 0.8rem; font-weight: 500;
      color: var(--text3); cursor: pointer; border-bottom: 2px solid transparent;
      transition: all 0.2s; white-space: nowrap; display: flex; align-items: center; gap: 5px;
      touch-action: manipulation; -webkit-tap-highlight-color: transparent;
      user-select: none;
    }
    .nav-tab:hover { color: var(--text2); }
    .nav-tab.active { color: var(--text); border-bottom-color: var(--gold); }
    .nav-tab-count {
      background: var(--bg3); border-radius: 50px; padding: 1px 5px;
      font-size: 0.62rem; font-family: var(--font-mono); color: var(--text3);
    }
    .nav-tab.active .nav-tab-count { background: var(--gold); color: #000; }

    /* â”€â”€â”€ SOURCE PILLS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .source-filter-bar {
      padding: 12px 16px 0; max-width: 1440px; margin: 0 auto;
      display: flex; align-items: center; gap: 8px; flex-wrap: wrap;
    }
    .source-pill {
      padding: 5px 12px; border-radius: 50px; font-size: 0.76rem; font-weight: 500;
      background: var(--bg2); border: 1px solid var(--border);
      color: var(--text2); cursor: pointer; transition: all 0.2s;
      display: flex; align-items: center; gap: 6px;
      touch-action: manipulation; -webkit-tap-highlight-color: transparent;
      user-select: none;
    }
    .source-pill .dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
    .source-pill:hover { border-color: var(--border2); color: var(--text); }
    .source-pill.active { color: white; border-color: transparent; }
    .source-pill[data-src="all"].active { background: var(--accent); }
    .source-pill[data-src="pib"].active { background: var(--pib); }
    .source-pill[data-src="hindu"].active { background: var(--hindu); }
    .source-pill[data-src="indianexpress"].active { background: var(--ie); }
    .source-pill[data-src="et"].active { background: var(--et); }

    /* â”€â”€â”€ MAIN CONTENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .main { padding: 16px; max-width: 1440px; margin: 0 auto; }

    /* â”€â”€â”€ HERO GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .hero-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
      gap: 14px; margin-bottom: 28px;
    }
    .hero-grid .card:first-child { grid-row: span 2; }

    /* â”€â”€â”€ CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .card {
      background: var(--bg1); border: 1px solid var(--border);
      border-radius: var(--radius-lg); overflow: hidden;
      transition: transform 0.2s, border-color 0.2s, box-shadow 0.2s;
      cursor: pointer; display: flex; flex-direction: column;
      animation: fadeUp 0.4s ease both;
      -webkit-tap-highlight-color: transparent;
    }
    .card:hover { transform: translateY(-2px); border-color: var(--border2); box-shadow: var(--shadow); }
    @keyframes fadeUp { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }

    .card-image { width: 100%; height: 180px; object-fit: cover; background: var(--bg3); flex-shrink: 0; }
    .hero-grid .card:first-child .card-image { height: 220px; }
    .card-no-image {
      width: 100%; background: var(--bg2);
      display: flex; align-items: center; justify-content: center;
      font-size: 2.5rem; flex-shrink: 0;
    }
    .card-no-image.sm { height: 110px; }
    .card-no-image.md { height: 160px; }
    .card-no-image.lg { height: 220px; }

    .card-body { padding: 14px; flex: 1; display: flex; flex-direction: column; gap: 7px; }
    .card-meta { display: flex; align-items: center; gap: 6px; flex-wrap: wrap; }

    .source-tag {
      font-size: 0.62rem; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase;
      padding: 2px 7px; border-radius: 4px; font-family: var(--font-mono);
    }
    .source-tag.pib           { background: rgba(249,115,22,0.15); color: #F97316; }
    .source-tag.hindu         { background: rgba(220,38,38,0.15);  color: #EF4444; }
    .source-tag.indianexpress { background: rgba(59,130,246,0.15); color: #60A5FA; }
    .source-tag.et            { background: rgba(16,185,129,0.15); color: #34D399; }

    .topic-tag {
      font-size: 0.6rem; padding: 2px 6px; border-radius: 4px;
      background: rgba(255,255,255,0.06); color: var(--text3); font-weight: 500;
    }
    .card-time { font-family: var(--font-mono); font-size: 0.6rem; color: var(--text3); margin-left: auto; }
    .card-title {
      font-family: var(--font-display); font-size: 1rem; line-height: 1.4;
      font-weight: 600; color: var(--text); flex: 1;
    }
    .hero-grid .card:first-child .card-title { font-size: 1.25rem; }
    .card-desc {
      font-size: 0.78rem; color: var(--text2); line-height: 1.6;
      display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;
    }
    .card-footer {
      display: flex; align-items: center; gap: 8px; padding: 9px 14px;
      border-top: 1px solid var(--border);
    }
    .read-link { font-size: 0.73rem; color: var(--text3); transition: color 0.2s; display: flex; align-items: center; gap: 4px; }
    .card:hover .read-link { color: var(--gold2); }
    .card-bookmark {
      margin-left: auto; color: var(--text3); font-size: 1rem;
      transition: color 0.2s; padding: 4px 6px; background: none; border: none;
      -webkit-tap-highlight-color: transparent; touch-action: manipulation;
    }
    .card-bookmark:hover, .card-bookmark.saved { color: var(--gold2); }

    /* â”€â”€â”€ SECTION HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .section-header { display: flex; align-items: center; gap: 12px; margin-bottom: 14px; }
    .section-title {
      font-family: var(--font-display); font-size: 1.3rem; font-weight: 700;
      color: var(--text); letter-spacing: 0.01em; white-space: nowrap;
    }
    .section-line { flex: 1; height: 1px; background: var(--border); }
    .section-count { font-family: var(--font-mono); font-size: 0.68rem; color: var(--text3); white-space: nowrap; }

    /* â”€â”€â”€ NEWS GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .news-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 14px;
    }

    /* â”€â”€â”€ LIST VIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .news-list { display: flex; flex-direction: column; gap: 8px; }
    .list-item {
      background: var(--bg1); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 13px 14px;
      display: flex; gap: 12px; align-items: flex-start;
      cursor: pointer; transition: all 0.2s; animation: fadeUp 0.3s ease both;
      -webkit-tap-highlight-color: transparent;
    }
    .list-item:hover { background: var(--bg2); border-color: var(--border2); }
    .list-item-num {
      font-family: var(--font-mono); font-size: 0.68rem; color: var(--text3);
      padding-top: 3px; flex-shrink: 0; min-width: 22px;
    }
    .list-item-content { flex: 1; min-width: 0; }
    .list-item-title {
      font-family: var(--font-display); font-size: 0.95rem; line-height: 1.4;
      font-weight: 600; color: var(--text); margin-bottom: 5px;
      word-break: break-word;
    }
    .list-item-desc {
      font-size: 0.76rem; color: var(--text2); line-height: 1.5;
      display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
    }

    /* â”€â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .layout-with-sidebar { display: grid; grid-template-columns: 1fr 300px; gap: 20px; }
    .sidebar { display: flex; flex-direction: column; gap: 16px; }
    .sidebar-card { background: var(--bg1); border: 1px solid var(--border); border-radius: var(--radius-lg); overflow: hidden; }
    .sidebar-card-header {
      padding: 12px 14px; border-bottom: 1px solid var(--border);
      font-family: var(--font-display); font-size: 0.95rem; font-weight: 600;
      display: flex; align-items: center; gap: 7px; color: var(--text);
    }
    .sidebar-card-body { padding: 10px; }

    .source-stat {
      display: flex; align-items: center; gap: 8px; padding: 7px 4px;
      border-bottom: 1px solid var(--border); cursor: pointer; transition: all 0.15s;
    }
    .source-stat:last-child { border-bottom: none; }
    .source-stat:hover { background: var(--bg2); border-radius: 6px; padding-left: 8px; }
    .source-stat-dot { width: 9px; height: 9px; border-radius: 50%; flex-shrink: 0; }
    .source-stat-name { font-size: 0.8rem; font-weight: 500; flex: 1; color: var(--text); }
    .source-stat-count {
      font-family: var(--font-mono); font-size: 0.68rem; color: var(--text3);
      background: var(--bg2); padding: 2px 7px; border-radius: 50px;
    }

    .topic-chip {
      display: inline-flex; align-items: center; gap: 4px;
      padding: 4px 9px; margin: 2px; border-radius: 50px;
      background: var(--bg2); border: 1px solid var(--border);
      font-size: 0.72rem; color: var(--text2); cursor: pointer; transition: all 0.2s;
      touch-action: manipulation;
    }
    .topic-chip:hover { background: var(--bg3); border-color: var(--border2); color: var(--text); }
    .topic-chip.active { background: var(--gold); border-color: var(--gold); color: #000; font-weight: 600; }
    .topic-chip-count {
      background: rgba(0,0,0,0.2); border-radius: 50px;
      padding: 0 4px; font-family: var(--font-mono); font-size: 0.6rem;
    }

    /* â”€â”€â”€ LOADING SKELETON â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .skeleton {
      animation: shimmer 1.5s infinite;
      background: linear-gradient(90deg, var(--bg2) 25%, var(--bg3) 50%, var(--bg2) 75%);
      background-size: 400% 100%; border-radius: 4px;
    }
    @keyframes shimmer { 0% { background-position: 100% 0; } 100% { background-position: -100% 0; } }
    .skeleton-card { background: var(--bg1); border: 1px solid var(--border); border-radius: var(--radius-lg); overflow: hidden; }
    .sk-img { height: 160px; }
    .sk-body { padding: 14px; display: flex; flex-direction: column; gap: 9px; }
    .sk-line { height: 11px; }
    .sk-title { height: 17px; width: 90%; }
    .sk-desc1 { height: 9px; }
    .sk-desc2 { height: 9px; width: 70%; }

    /* â”€â”€â”€ NOTIFICATION PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .notif-panel {
      position: fixed; right: 16px; top: 64px; width: 340px; z-index: 200;
      background: var(--bg1); border: 1px solid var(--border2);
      border-radius: var(--radius-lg); box-shadow: var(--shadow-lg);
      transform: translateY(-10px) scale(0.98); opacity: 0;
      transition: all 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
      pointer-events: none; max-height: calc(100vh - 80px); overflow-y: auto;
    }
    .notif-panel.open { transform: translateY(0) scale(1); opacity: 1; pointer-events: all; }
    .notif-panel-header {
      padding: 14px 16px; border-bottom: 1px solid var(--border);
      display: flex; align-items: center; gap: 8px; position: sticky; top: 0;
      background: var(--bg1); z-index: 1;
    }
    .notif-panel-title { font-family: var(--font-display); font-size: 0.95rem; font-weight: 600; flex: 1; }
    .notif-close { color: var(--text3); padding: 6px; font-size: 1.1rem; touch-action: manipulation; }
    .notif-close:hover { color: var(--text); }
    .notif-body { padding: 14px; display: flex; flex-direction: column; gap: 12px; }
    .notif-row { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
    .notif-label { font-size: 0.83rem; color: var(--text2); }
    .notif-sub { font-size: 0.7rem; color: var(--text3); margin-top: 2px; }
    .toggle {
      width: 44px; height: 25px; background: var(--bg3); border-radius: 50px;
      position: relative; cursor: pointer; transition: background 0.2s; flex-shrink: 0;
      border: 1px solid var(--border2); touch-action: manipulation;
    }
    .toggle.on { background: var(--green); border-color: var(--green); }
    .toggle::after {
      content: ''; position: absolute; top: 3px; left: 3px;
      width: 17px; height: 17px; border-radius: 50%;
      background: white; transition: transform 0.2s; box-shadow: 0 1px 4px rgba(0,0,0,0.3);
    }
    .toggle.on::after { transform: translateX(19px); }
    .notif-interval { display: flex; gap: 5px; flex-wrap: wrap; }
    .interval-btn {
      padding: 4px 9px; border-radius: 50px; font-size: 0.7rem;
      background: var(--bg2); border: 1px solid var(--border2); color: var(--text2);
      cursor: pointer; transition: all 0.15s; touch-action: manipulation;
    }
    .interval-btn.active { background: var(--accent); border-color: var(--accent); color: white; }
    .notif-save {
      width: 100%; padding: 10px; border-radius: var(--radius);
      background: linear-gradient(135deg, var(--gold) 0%, #8B6914 100%);
      color: #000; font-weight: 600; font-size: 0.85rem; transition: opacity 0.2s;
      touch-action: manipulation;
    }
    .notif-save:hover { opacity: 0.9; }

    /* â”€â”€â”€ BOOKMARKS PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .bookmarks-panel {
      position: fixed; right: 16px; top: 64px; width: 360px; z-index: 200;
      background: var(--bg1); border: 1px solid var(--border2);
      border-radius: var(--radius-lg); box-shadow: var(--shadow-lg);
      max-height: calc(100vh - 80px); overflow-y: auto;
      transform: translateY(-10px) scale(0.98); opacity: 0;
      transition: all 0.25s cubic-bezier(0.34, 1.56, 0.64, 1); pointer-events: none;
    }
    .bookmarks-panel.open { transform: translateY(0) scale(1); opacity: 1; pointer-events: all; }
    .bookmarks-panel-header {
      padding: 14px 16px; border-bottom: 1px solid var(--border);
      display: flex; align-items: center; gap: 8px; position: sticky; top: 0;
      background: var(--bg1); z-index: 1;
    }

    /* â”€â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .toast-container {
      position: fixed; bottom: calc(72px + var(--safe-bottom)); left: 50%;
      transform: translateX(-50%); z-index: 500; display: flex;
      flex-direction: column; gap: 8px; align-items: center; width: 90%; max-width: 360px;
    }
    .toast {
      background: var(--bg3); border: 1px solid var(--border2); border-radius: 50px;
      padding: 10px 18px; font-size: 0.8rem; color: var(--text);
      box-shadow: var(--shadow); animation: toastIn 0.3s ease, toastOut 0.3s ease 2.5s forwards;
      display: flex; align-items: center; gap: 8px; white-space: nowrap;
    }
    @keyframes toastIn { from { opacity:0; transform:translateY(12px); } to { opacity:1; transform:translateY(0); } }
    @keyframes toastOut { to { opacity:0; transform:translateY(12px); } }

    /* â”€â”€â”€ EMPTY STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .empty-state { text-align: center; padding: 48px 20px; color: var(--text3); }
    .empty-state .icon { font-size: 2.8rem; margin-bottom: 12px; }
    .empty-state h3 { font-family: var(--font-display); font-size: 1.2rem; color: var(--text2); margin-bottom: 6px; }
    .empty-state p { font-size: 0.83rem; }

    /* â”€â”€â”€ REFRESH BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .refresh-bar {
      display: flex; align-items: center; justify-content: space-between;
      padding: 8px 16px; background: var(--bg1); border-bottom: 1px solid var(--border);
      max-width: 1440px; margin: 0 auto; gap: 10px;
    }
    .refresh-info {
      font-size: 0.72rem; color: var(--text3);
      display: flex; align-items: center; gap: 6px; flex: 1; min-width: 0;
    }
    .refresh-info span { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .live-dot { width: 7px; height: 7px; border-radius: 50%; background: var(--green); animation: pulse 2s infinite; flex-shrink: 0; }
    @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:0.4;} }
    .btn-refresh {
      display: flex; align-items: center; gap: 5px; flex-shrink: 0;
      background: var(--bg2); border: 1px solid var(--border2);
      border-radius: 50px; padding: 4px 12px; font-size: 0.75rem;
      color: var(--text2); transition: all 0.2s; touch-action: manipulation;
    }
    .btn-refresh:hover { color: var(--text); border-color: var(--accent); }
    .btn-refresh.spinning .refresh-ico { animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* â”€â”€â”€ VIEW TOGGLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .view-toggle { display: flex; gap: 4px; }
    .view-btn {
      width: 30px; height: 30px; border-radius: 6px;
      background: var(--bg2); border: 1px solid var(--border);
      display: flex; align-items: center; justify-content: center;
      font-size: 0.85rem; color: var(--text3); cursor: pointer; transition: all 0.15s;
      touch-action: manipulation;
    }
    .view-btn.active { background: var(--bg3); border-color: var(--border2); color: var(--text); }

    /* â”€â”€â”€ MOBILE BOTTOM NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .mobile-nav {
      display: none; position: fixed; bottom: 0; left: 0; right: 0; z-index: 100;
      background: rgba(13,17,32,0.97); backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-top: 1px solid var(--border);
      padding: 6px 0; padding-bottom: calc(6px + var(--safe-bottom));
    }
    .mobile-nav-inner { display: flex; justify-content: space-around; align-items: stretch; }
    .mobile-nav-item {
      display: flex; flex-direction: column; align-items: center; gap: 2px;
      padding: 5px 8px; border-radius: 8px; color: var(--text3);
      font-size: 0.58rem; letter-spacing: 0.04em; cursor: pointer;
      transition: color 0.2s; flex: 1; min-width: 0;
      touch-action: manipulation; -webkit-tap-highlight-color: transparent; user-select: none;
    }
    .mobile-nav-item.active { color: var(--gold2); }
    .mobile-nav-item span.ico { font-size: 1.3rem; line-height: 1; }
    .mobile-nav-item span.lbl { display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; width: 100%; text-align: center; }

    /* â”€â”€â”€ PROGRESS BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #progress-bar {
      position: fixed; top: 0; left: 0; height: 2px;
      background: linear-gradient(90deg, var(--gold), var(--accent));
      z-index: 999; width: 0; transition: width 0.3s ease;
    }

    /* â”€â”€â”€ HIGHLIGHT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .highlight { background: rgba(201,168,76,0.25); border-radius: 2px; color: var(--gold2); }

    /* â”€â”€â”€ CARD STAGGER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .card:nth-child(1) { animation-delay: 0.05s; }
    .card:nth-child(2) { animation-delay: 0.08s; }
    .card:nth-child(3) { animation-delay: 0.12s; }
    .card:nth-child(4) { animation-delay: 0.16s; }
    .card:nth-child(5) { animation-delay: 0.20s; }
    .card:nth-child(6) { animation-delay: 0.24s; }

    /* â”€â”€â”€ SCROLLBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    ::-webkit-scrollbar { width: 5px; height: 5px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: var(--bg3); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--surface); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESPONSIVE BREAKPOINTS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

    /* â”€â”€ Large Desktop (â‰¥1280px) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (min-width: 1280px) {
      .header-inner { padding: 10px 24px; }
      .last-update { display: block; }
      .nav-tabs { padding: 0 24px; }
      .source-filter-bar { padding: 14px 24px 0; }
      .main { padding: 24px; }
      .news-grid { grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); }
    }

    /* â”€â”€ Tablet (769px â€“ 1279px) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 1279px) {
      .layout-with-sidebar { grid-template-columns: 1fr; }
      .sidebar { display: none; }
    }
    @media (min-width: 769px) and (max-width: 1279px) {
      .hero-grid { grid-template-columns: 1fr 1fr; }
      .news-grid { grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); }
    }

    /* â”€â”€ Mobile (â‰¤768px) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 768px) {
      /* Header */
      .header-inner { padding: 8px 12px; gap: 8px; min-height: 52px; }
      .header-search { display: none; } /* replaced by overlay */
      .btn-mobile-search { display: flex; }
      .logo-sub { display: none; }
      .logo-title { font-size: 1.05rem; }
      .btn-refresh-text { display: none; } /* icon-only refresh on mobile */
      .btn-refresh { padding: 0; width: 38px; height: 38px; border-radius: 50%; justify-content: center; }

      /* Bottom nav */
      .mobile-nav { display: flex; }

      /* Main content â€” space for bottom nav */
      .main { padding: 12px 12px calc(70px + var(--safe-bottom)) 12px; }

      /* Hero grid â€” single column */
      .hero-grid { grid-template-columns: 1fr; gap: 10px; margin-bottom: 18px; }
      .hero-grid .card:first-child { grid-row: span 1; }
      .hero-grid .card:first-child .card-image { height: 200px; }
      .hero-grid .card:first-child .card-title { font-size: 1.1rem; }

      /* Cards */
      .news-grid { grid-template-columns: 1fr; gap: 10px; }
      .card-image { height: 160px; }
      .card-no-image.sm { height: 100px; }
      .card-body { padding: 12px; }
      .card-title { font-size: 0.95rem; }
      .card-desc { -webkit-line-clamp: 2; }

      /* Panels â€” full width */
      .notif-panel, .bookmarks-panel {
        left: 8px; right: 8px; width: auto; top: 60px;
        max-height: calc(100vh - 130px - var(--safe-bottom));
      }

      /* Tabs */
      .nav-tab { padding: 10px 12px; font-size: 0.76rem; }

      /* Source pills */
      .source-filter-bar { padding: 10px 12px 0; gap: 6px; }
      .source-pill { padding: 4px 10px; font-size: 0.72rem; }

      /* Refresh bar */
      .refresh-bar { padding: 7px 12px; }
      .refresh-info { font-size: 0.68rem; }

      /* Section header */
      .section-title { font-size: 1.1rem; }

      /* Toast above bottom nav */
      .toast-container { bottom: calc(68px + var(--safe-bottom)); }

      /* List items */
      .list-item { padding: 11px 12px; }
      .list-item-title { font-size: 0.88rem; }
    }

    /* â”€â”€ Small Mobile (â‰¤400px) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 400px) {
      .logo-icon { width: 30px; height: 30px; font-size: 15px; }
      .logo-title { font-size: 0.95rem; }
      .mobile-nav-item { font-size: 0.54rem; padding: 5px 4px; }
      .mobile-nav-item span.ico { font-size: 1.15rem; }
      .source-pill .pill-label { display: none; } /* show only dot on very small screens */
      .hero-grid .card:first-child .card-image { height: 170px; }
    }

    /* â”€â”€ Wide screens â€” cap hero image height â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (min-width: 1440px) {
      .hero-grid .card:first-child .card-image { height: 260px; }
      .hero-grid .card:first-child .card-title { font-size: 1.4rem; }
    }

    /* â”€â”€ Print styles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media print {
      .mobile-nav, .ticker-bar, .notif-panel, .bookmarks-panel,
      .bg-orbs, .header-actions, .refresh-bar, #progress-bar,
      .source-filter-bar, .card-bookmark { display: none !important; }
      body { background: white; color: black; }
      .card { border: 1px solid #ccc; break-inside: avoid; }
      .card-title { color: black; }
    }
  </style>
</head>
<body>

<div id="progress-bar" role="progressbar" aria-label="Loading news"></div>
<div class="bg-orbs" aria-hidden="true"><span></span><span></span><span></span></div>

<!-- â•â•â• SKIP TO CONTENT (accessibility) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<a href="#main-content" style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;z-index:999;background:var(--bg1);color:var(--text);padding:8px 16px;border-radius:4px" onfocus="this.style.left='8px';this.style.width='auto';this.style.height='auto'" onblur="this.style.left='-9999px'">Skip to main content</a>

<!-- â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<header role="banner">
  <div class="header-inner">
    <a class="logo" href="/" aria-label="UPSC Samachar Home">
      <div class="logo-icon" aria-hidden="true">ğŸ“œ</div>
      <div class="logo-text">
        <span class="logo-title">UPSC Samachar</span>
        <span class="logo-sub">Intelligence for Aspirants</span>
      </div>
    </a>

    <!-- Desktop search -->
    <div class="header-search" role="search">
      <svg class="search-icon" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input type="search" id="searchInput" placeholder="Search news, topics, keywordsâ€¦" autocomplete="off" autocorrect="off" spellcheck="false" aria-label="Search UPSC news" />
    </div>

    <div class="header-actions">
      <span class="last-update" id="lastUpdateText" aria-live="polite">â€”</span>

      <!-- Mobile search trigger -->
      <button class="btn-icon btn-mobile-search" id="btnMobileSearch" aria-label="Search" title="Search">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      </button>

      <button class="btn-icon" id="btnBookmarks" aria-label="Saved articles" title="Saved articles">
        ğŸ”–
        <span class="notif-badge" id="bookmarkBadge" style="display:none" aria-hidden="true"></span>
      </button>

      <button class="btn-icon" id="btnNotif" aria-label="Notification settings" title="Notification settings" aria-expanded="false" aria-controls="notifPanel">
        ğŸ””
      </button>

      <button class="btn-icon btn-refresh" id="btnRefresh" aria-label="Refresh news" title="Refresh news">
        <span class="refresh-ico" aria-hidden="true">â†»</span>
        <span class="btn-refresh-text">Refresh</span>
      </button>
    </div>
  </div>
</header>

<!-- â•â•â• MOBILE SEARCH OVERLAY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="mobile-search-overlay" id="mobileSearchOverlay" role="search" aria-label="Search news">
  <div class="search-row">
    <div style="position:relative;flex:1">
      <svg style="position:absolute;left:14px;top:50%;transform:translateY(-50%);color:var(--text3)" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input type="search" id="mobileSearchInput" placeholder="Search news, topics, ministriesâ€¦" autocomplete="off" autocorrect="off" spellcheck="false" aria-label="Search UPSC news" />
    </div>
    <button class="cancel-btn" id="mobileSearchCancel">Cancel</button>
  </div>
  <div class="mobile-search-suggestions">
    <strong>Quick Searches</strong>
    <span class="suggestion-chip" onclick="doMobileSearch('Budget')">Budget</span>
    <span class="suggestion-chip" onclick="doMobileSearch('RBI')">RBI</span>
    <span class="suggestion-chip" onclick="doMobileSearch('ISRO')">ISRO</span>
    <span class="suggestion-chip" onclick="doMobileSearch('Supreme Court')">Supreme Court</span>
    <span class="suggestion-chip" onclick="doMobileSearch('Cabinet')">Cabinet</span>
    <span class="suggestion-chip" onclick="doMobileSearch('Defence')">Defence</span>
    <span class="suggestion-chip" onclick="doMobileSearch('Environment')">Environment</span>
    <span class="suggestion-chip" onclick="doMobileSearch('G20')">G20</span>
  </div>
</div>

<!-- â•â•â• TICKER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="ticker-bar" aria-label="Live news ticker" role="marquee">
  <div class="ticker-label" aria-hidden="true">LIVE</div>
  <div style="overflow:hidden;flex:1" aria-live="off">
    <div class="ticker-track" id="tickerTrack">
      <span class="ticker-item">Loading latest headlinesâ€¦</span>
    </div>
  </div>
</div>

<!-- â•â•â• NAV TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav aria-label="News categories" class="nav-tabs-container">
  <div class="nav-tabs" id="navTabs" role="tablist">
    <div class="nav-tab active" data-tab="all" role="tab" aria-selected="true" tabindex="0">ğŸ— All <span class="nav-tab-count" id="count-all">0</span></div>
    <div class="nav-tab" data-tab="polity" role="tab" aria-selected="false" tabindex="-1">âš–ï¸ Polity <span class="nav-tab-count" id="count-polity">0</span></div>
    <div class="nav-tab" data-tab="economy" role="tab" aria-selected="false" tabindex="-1">ğŸ“ˆ Economy <span class="nav-tab-count" id="count-economy">0</span></div>
    <div class="nav-tab" data-tab="environment" role="tab" aria-selected="false" tabindex="-1">ğŸŒ¿ Environment <span class="nav-tab-count" id="count-environment">0</span></div>
    <div class="nav-tab" data-tab="science" role="tab" aria-selected="false" tabindex="-1">ğŸ”¬ Science & Tech <span class="nav-tab-count" id="count-science">0</span></div>
    <div class="nav-tab" data-tab="international" role="tab" aria-selected="false" tabindex="-1">ğŸŒ International <span class="nav-tab-count" id="count-international">0</span></div>
    <div class="nav-tab" data-tab="social" role="tab" aria-selected="false" tabindex="-1">ğŸ¤ Social <span class="nav-tab-count" id="count-social">0</span></div>
    <div class="nav-tab" data-tab="defence" role="tab" aria-selected="false" tabindex="-1">ğŸ›¡ Defence <span class="nav-tab-count" id="count-defence">0</span></div>
    <div class="nav-tab" data-tab="infra" role="tab" aria-selected="false" tabindex="-1">ğŸ— Infra <span class="nav-tab-count" id="count-infra">0</span></div>
    <div class="nav-tab" data-tab="bookmarks" role="tab" aria-selected="false" tabindex="-1">ğŸ”– Saved <span class="nav-tab-count" id="count-bookmarks">0</span></div>
  </div>
</nav>

<!-- â•â•â• REFRESH BAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="refresh-bar" role="status" aria-live="polite">
  <div class="refresh-info">
    <div class="live-dot" aria-hidden="true"></div>
    <span id="refreshStatus">Connecting to news sourcesâ€¦</span>
  </div>
  <div style="display:flex;align-items:center;gap:8px;flex-shrink:0">
    <div class="view-toggle" aria-label="View mode">
      <button class="view-btn active" id="viewGrid" aria-label="Grid view" aria-pressed="true" title="Grid view">âŠ</button>
      <button class="view-btn" id="viewList" aria-label="List view" aria-pressed="false" title="List view">â˜°</button>
    </div>
    <button class="btn-refresh" id="btnRefreshBar" aria-label="Refresh news feed">
      <span class="refresh-ico" aria-hidden="true">â†»</span>
      <span class="btn-refresh-text">Refresh</span>
    </button>
  </div>
</div>

<!-- â•â•â• SOURCE FILTERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="source-filter-bar" role="group" aria-label="Filter by news source">
  <button class="source-pill active" data-src="all" aria-pressed="true">All Sources</button>
  <button class="source-pill" data-src="pib" aria-pressed="false"><span class="dot" style="background:var(--pib)" aria-hidden="true"></span><span class="pill-label">PIB</span></button>
  <button class="source-pill" data-src="hindu" aria-pressed="false"><span class="dot" style="background:var(--hindu)" aria-hidden="true"></span><span class="pill-label">The Hindu</span></button>
  <button class="source-pill" data-src="indianexpress" aria-pressed="false"><span class="dot" style="background:var(--ie)" aria-hidden="true"></span><span class="pill-label">Indian Express</span></button>
  <button class="source-pill" data-src="et" aria-pressed="false"><span class="dot" style="background:var(--et)" aria-hidden="true"></span><span class="pill-label">Eco Times</span></button>
</div>

<!-- â•â•â• MAIN CONTENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main class="main" id="main-content" role="main">
  <div class="layout-with-sidebar">
    <div>
      <div id="heroSection" aria-label="Featured articles">
        <div class="hero-grid" id="heroGrid"></div>
      </div>
      <div class="section-header" id="mainSectionHeader">
        <h1 class="section-title" id="mainSectionTitle">Latest News</h1>
        <div class="section-line" aria-hidden="true"></div>
        <span class="section-count" id="mainSectionCount" aria-live="polite"></span>
      </div>
      <div id="articlesContainer" aria-live="polite" aria-label="News articles"></div>
    </div>

    <!-- Sidebar (desktop only) -->
    <aside class="sidebar" aria-label="News statistics and filters">
      <div class="sidebar-card">
        <div class="sidebar-card-header">ğŸ“° Sources</div>
        <div class="sidebar-card-body" id="sourcesStats"></div>
      </div>
      <div class="sidebar-card">
        <div class="sidebar-card-header">ğŸ· Topics</div>
        <div class="sidebar-card-body" id="topicsCloud"></div>
      </div>
      <div class="sidebar-card" id="pibMinistryCard" style="display:none">
        <div class="sidebar-card-header">ğŸ›ï¸ PIB by Ministry</div>
        <div class="sidebar-card-body" id="pibMinistryList"></div>
      </div>
      <div class="sidebar-card">
        <div class="sidebar-card-header">â° Auto-Refresh</div>
        <div class="sidebar-card-body" style="padding:14px;">
          <div style="font-size:0.78rem;color:var(--text2);margin-bottom:8px;">Next refresh in</div>
          <div style="font-family:var(--font-mono);font-size:1.7rem;color:var(--gold2);letter-spacing:0.05em;" id="sidebarCountdown">â€”</div>
          <div style="font-size:0.7rem;color:var(--text3);margin-top:5px;" id="sidebarNextTime"></div>
        </div>
      </div>
    </aside>
  </div>
</main>

<!-- â•â•â• NOTIFICATION PANEL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="notif-panel" id="notifPanel" role="dialog" aria-modal="true" aria-label="Notification Settings">
  <div class="notif-panel-header">
    <span aria-hidden="true">ğŸ””</span>
    <span class="notif-panel-title">Notification Settings</span>
    <button class="notif-close" id="notifClose" aria-label="Close settings">âœ•</button>
  </div>
  <div class="notif-body">
    <div class="notif-row">
      <div>
        <div class="notif-label">Browser Notifications</div>
        <div class="notif-sub">Get alerts for breaking UPSC news</div>
      </div>
      <div class="toggle" id="toggleNotif" onclick="toggleSetting('notif')" role="switch" aria-checked="false" tabindex="0"></div>
    </div>
    <div class="notif-row">
      <div>
        <div class="notif-label">Auto-Refresh Feed</div>
        <div class="notif-sub">Automatically fetch new articles</div>
      </div>
      <div class="toggle on" id="toggleAutoRefresh" onclick="toggleSetting('autoRefresh')" role="switch" aria-checked="true" tabindex="0"></div>
    </div>
    <div>
      <div class="notif-label" style="margin-bottom:7px;">Refresh Interval</div>
      <div class="notif-interval" id="intervalBtns">
        <button class="interval-btn" data-mins="5">5 min</button>
        <button class="interval-btn active" data-mins="10">10 min</button>
        <button class="interval-btn" data-mins="15">15 min</button>
        <button class="interval-btn" data-mins="30">30 min</button>
        <button class="interval-btn" data-mins="60">1 hr</button>
      </div>
    </div>
    <div>
      <div class="notif-label" style="margin-bottom:7px;">Notify for Topics</div>
      <div id="notifTopics" style="display:flex;flex-wrap:wrap;gap:5px;"></div>
    </div>
    <button class="notif-save" onclick="saveNotifSettings()">Save Settings</button>
  </div>
</div>

<!-- â•â•â• BOOKMARKS PANEL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="bookmarks-panel" id="bookmarksPanel" role="dialog" aria-modal="true" aria-label="Saved Articles">
  <div class="bookmarks-panel-header">
    <span aria-hidden="true">ğŸ”–</span>
    <span class="notif-panel-title">Saved Articles</span>
    <button class="notif-close" onclick="closePanels()" aria-label="Close saved articles">âœ•</button>
  </div>
  <div id="bookmarksList" style="padding:10px;"></div>
</div>

<!-- â•â•â• MOBILE BOTTOM NAV â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav class="mobile-nav" aria-label="Mobile navigation">
  <div class="mobile-nav-inner">
    <div class="mobile-nav-item active" onclick="setMobileTab('all', this)" role="button" aria-label="All news" tabindex="0">
      <span class="ico" aria-hidden="true">ğŸ—</span><span class="lbl">All</span>
    </div>
    <div class="mobile-nav-item" onclick="setMobileTab('economy', this)" role="button" aria-label="Economy news" tabindex="0">
      <span class="ico" aria-hidden="true">ğŸ“ˆ</span><span class="lbl">Economy</span>
    </div>
    <div class="mobile-nav-item" onclick="setMobileTab('polity', this)" role="button" aria-label="Polity news" tabindex="0">
      <span class="ico" aria-hidden="true">âš–ï¸</span><span class="lbl">Polity</span>
    </div>
    <div class="mobile-nav-item" onclick="setMobileTab('science', this)" role="button" aria-label="Science news" tabindex="0">
      <span class="ico" aria-hidden="true">ğŸ”¬</span><span class="lbl">Science</span>
    </div>
    <div class="mobile-nav-item" onclick="toggleBookmarks()" role="button" aria-label="Saved articles" tabindex="0">
      <span class="ico" aria-hidden="true">ğŸ”–</span><span class="lbl">Saved</span>
    </div>
    <div class="mobile-nav-item" onclick="document.getElementById('btnNotif').click()" role="button" aria-label="Settings" tabindex="0">
      <span class="ico" aria-hidden="true">âš™ï¸</span><span class="lbl">Settings</span>
    </div>
  </div>
</nav>

<!-- â•â•â• TOAST CONTAINER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="toast-container" id="toastContainer" role="status" aria-live="polite" aria-atomic="true"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UPSC SAMACHAR â€” CLIENT APP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let state = {
  articles: [], grouped: {}, topicGrouped: {}, pibByMinistry: {},
  sources: [], topics: [], lastUpdated: null, total: 0,
  currentTab: 'all', currentSource: 'all', searchQuery: '',
  viewMode: 'grid',
  bookmarks: JSON.parse(localStorage.getItem('upsc_bookmarks') || '[]'),
  notifSettings: JSON.parse(localStorage.getItem('upsc_notif') || JSON.stringify({
    notif: false, autoRefresh: true, intervalMins: 10,
    notifTopics: ['Polity & Governance', 'Economy']
  })),
  refreshTimer: null, nextRefreshAt: 0, loading: true,
};

const TOPIC_MAP = {
  'polity':        'Polity & Governance',
  'economy':       'Economy',
  'environment':   'Environment & Ecology',
  'science':       'Science & Technology',
  'international': 'International Relations',
  'social':        'Social Issues',
  'defence':       'Defence & Security',
  'infra':         'Infrastructure & Development',
};

// â”€â”€ API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Convert PIB item (from pib_index.json) â†’ unified article format
function pibItemToArticle(item) {
  return {
    id: 'pib_' + item.prid,
    title: item.title || '',
    description: item.snippet || '',
    link: item.source_url || ('https://pib.gov.in/PressReleasePage.aspx?PRID=' + item.prid),
    pubDate: item.pub_date || new Date().toISOString(),
    source: 'pib',
    sourceName: 'PIB',
    sourceFullName: 'Press Information Bureau',
    sourceColor: '#F97316',
    category: item.ministry || 'Press Release',
    ministry: item.ministry || '',
    topics: item.topics || ['General'],
    imageUrl: '',
    prid: item.prid,
  };
}

async function fetchNews() {
  setProgress(10);
  state.loading = true;
  document.getElementById('refreshStatus').textContent = 'Fetching from PIB, The Hindu, Indian Express, Economic Timesâ€¦';
  showSkeleton();

  try {
    // Fetch PIB static JSON + RSS API in parallel
    const [pibRes, rssRes] = await Promise.allSettled([
      fetch('/data/pib_index.json', { cache: 'no-store' }),
      fetch('/api/news'),
    ]);

    setProgress(60);

    // â”€â”€ PIB (static JSON built by scrape_pib.py) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let pibArticles = [];
    let pibByMinistry = {};
    let pibUpdatedAt = null;

    if (pibRes.status === 'fulfilled' && pibRes.value.ok) {
      try {
        const pibData = await pibRes.value.json();
        pibUpdatedAt = pibData.updated_at_utc;
        pibArticles = (pibData.items || []).map(pibItemToArticle);
        // Build ministry grouping
        pibArticles.forEach(a => {
          const m = a.ministry || 'Other';
          if (!pibByMinistry[m]) pibByMinistry[m] = [];
          pibByMinistry[m].push(a);
        });
        console.log(`PIB: loaded ${pibArticles.length} articles from static JSON`);
      } catch (e) {
        console.warn('PIB JSON parse error:', e);
      }
    } else {
      console.warn('PIB static JSON not available â€” run scrape_pib.py first');
    }

    // â”€â”€ RSS feeds (Hindu / IE / ET) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let rssArticles = [];
    let rssGrouped = {};
    let rssSources = [];
    let rssTopics = [];
    let rssTopicGrouped = {};

    if (rssRes.status === 'fulfilled' && rssRes.value.ok) {
      try {
        const rssData = await rssRes.value.json();
        rssArticles = rssData.articles || [];
        rssGrouped = rssData.grouped || {};
        rssSources = rssData.sources || [];
        rssTopics = rssData.topics || [];
        rssTopicGrouped = rssData.topicGrouped || {};
      } catch (e) {
        console.warn('RSS JSON parse error:', e);
      }
    } else {
      console.warn('RSS API unavailable');
    }

    setProgress(85);

    // â”€â”€ Merge PIB + RSS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const PIB_SOURCE = { id: 'pib', name: 'PIB', fullName: 'Press Information Bureau', color: '#F97316' };

    // Deduplicate merged list
    const seen = new Set();
    const allArticles = [...pibArticles, ...rssArticles].filter(a => {
      if (!a || !a.title) return false;
      const key = a.title.toLowerCase().replace(/[^a-z0-9]/g, '').slice(0, 60);
      if (seen.has(key)) return false;
      seen.add(key); return true;
    });
    allArticles.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));

    // Merged grouped
    const allGrouped = { pib: pibArticles, ...rssGrouped };

    // Merged topic grouping
    const allTopicGrouped = { ...rssTopicGrouped };
    pibArticles.forEach(a => {
      (a.topics || []).forEach(t => {
        if (!allTopicGrouped[t]) allTopicGrouped[t] = [];
        // avoid duplicates
        if (!allTopicGrouped[t].find(x => x.id === a.id)) allTopicGrouped[t].push(a);
      });
    });

    // Sources list (PIB first)
    const allSources = [PIB_SOURCE, ...rssSources.filter(s => s.id !== 'pib')];

    // Topics
    const TOPIC_LIST = [
      'Polity & Governance','Economy','Environment & Ecology','Science & Technology',
      'International Relations','Social Issues','Defence & Security','Infrastructure & Development'
    ];

    state.articles      = allArticles;
    state.grouped       = allGrouped;
    state.topicGrouped  = allTopicGrouped;
    state.pibByMinistry = pibByMinistry;
    state.sources       = allSources;
    state.topics        = rssTopics.length ? rssTopics : TOPIC_LIST;
    state.lastUpdated   = pibUpdatedAt || new Date().toISOString();
    state.total         = allArticles.length;

    setProgress(100);
    state.loading = false;
    renderAll();
    updateTicker();
    scheduleRefresh();

    const pibCount = pibArticles.length;
    const rssCount = rssArticles.length;
    showToast(`âœ… ${state.total} articles â€” PIB: ${pibCount}, Newspapers: ${rssCount}`);
    if (state.notifSettings.notif) checkForNewArticles();

  } catch (e) {
    setProgress(0);
    state.loading = false;
    document.getElementById('refreshStatus').textContent = 'âš  Error â€” showing sample data';
    renderDemoData();
    showToast('âš  Using sample data â€” check connection');
    console.error(e);
  }
}

// â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderAll() {
  updateCounts(); renderHero(); renderArticles(); renderSidebar(); updateLastUpdate();
}

function getFilteredArticles() {
  let articles = state.articles;
  if (state.currentSource !== 'all')
    articles = articles.filter(a => a.source === state.currentSource);
  if (state.currentTab === 'bookmarks') {
    const ids = new Set(state.bookmarks.map(b => b.id));
    const found = state.articles.filter(a => ids.has(a.id));
    return found.length ? found : state.bookmarks;
  }
  if (state.currentTab !== 'all') {
    const topicName = TOPIC_MAP[state.currentTab];
    if (topicName && state.topicGrouped[topicName]) {
      const ids = new Set(state.topicGrouped[topicName].map(a => a.id));
      articles = articles.filter(a => ids.has(a.id));
    }
  }
  if (state.searchQuery) {
    const q = state.searchQuery.toLowerCase();
    articles = articles.filter(a =>
      (a.title||'').toLowerCase().includes(q) ||
      (a.description||'').toLowerCase().includes(q) ||
      (a.sourceName||'').toLowerCase().includes(q) ||
      (a.ministry||'').toLowerCase().includes(q) ||
      (a.topics||[]).some(t => t.toLowerCase().includes(q))
    );
  }
  return articles;
}

function updateCounts() {
  const all = state.articles.length;
  document.getElementById('count-all').textContent = all;
  document.getElementById('refreshStatus').textContent =
    `${all} articles â€¢ Updated ${timeAgo(state.lastUpdated)}`;
  const topicMeta = [
    ['count-polity','Polity & Governance'],['count-economy','Economy'],
    ['count-environment','Environment & Ecology'],['count-science','Science & Technology'],
    ['count-international','International Relations'],['count-social','Social Issues'],
    ['count-defence','Defence & Security'],['count-infra','Infrastructure & Development'],
  ];
  topicMeta.forEach(([id, topic]) => {
    const el = document.getElementById(id);
    if (el) el.textContent = (state.topicGrouped[topic] || []).length;
  });
  document.getElementById('count-bookmarks').textContent = state.bookmarks.length;
  updateBookmarkBadge();
}

function renderHero() {
  const heroGrid = document.getElementById('heroGrid');
  if (state.currentTab !== 'all' || state.currentSource !== 'all' || state.searchQuery) {
    document.getElementById('heroSection').style.display = 'none'; return;
  }
  document.getElementById('heroSection').style.display = 'block';
  const top = state.articles.slice(0, 3);
  if (!top.length) { heroGrid.innerHTML = ''; return; }
  heroGrid.innerHTML = top.map((a, i) => buildCard(a, i === 0 ? 'lg' : 'sm', true)).join('');
}

function renderArticles() {
  const container = document.getElementById('articlesContainer');
  const articles  = getFilteredArticles();
  const titleMap  = { all:'Latest News', bookmarks:'Saved Articles' };
  const title     = titleMap[state.currentTab] || TOPIC_MAP[state.currentTab] || 'Articles';
  document.getElementById('mainSectionTitle').textContent = title;
  document.getElementById('mainSectionCount').textContent = articles.length + ' articles';
  if (!articles.length) {
    container.innerHTML = `<div class="empty-state">
      <div class="icon" aria-hidden="true">${state.currentTab === 'bookmarks' ? 'ğŸ”–' : 'ğŸ”'}</div>
      <h3>${state.currentTab === 'bookmarks' ? 'No saved articles yet' : 'No articles found'}</h3>
      <p>${state.currentTab === 'bookmarks' ? 'Tap the bookmark icon on any article to save it.' : 'Try different filters or search terms.'}</p>
    </div>`;
    return;
  }
  const skip = (state.currentTab === 'all' && state.currentSource === 'all' && !state.searchQuery) ? 3 : 0;
  const list = articles.slice(skip);
  if (state.viewMode === 'grid') {
    container.innerHTML = `<div class="news-grid">${list.map((a, i) => buildCard(a, 'sm', false, i)).join('')}</div>`;
  } else {
    container.innerHTML = `<div class="news-list">${list.map((a, i) => buildListItem(a, i)).join('')}</div>`;
  }
}

function buildCard(article, size = 'sm', isHero = false, idx = 0) {
  const delay = Math.min(idx * 0.05, 0.4);
  const saved = state.bookmarks.some(b => b.id === article.id);
  const topicsHtml = (article.topics || []).slice(0, 2).map(t => `<span class="topic-tag">${escHtml(t)}</span>`).join('');
  const imgHtml = article.imageUrl
    ? `<img class="card-image" src="${escHtml(article.imageUrl)}" alt="${escHtml(article.title)}" loading="lazy" onerror="this.parentNode.replaceChild(Object.assign(document.createElement('div'),{className:'card-no-image ${size}',textContent:'${sourceEmoji(article.source)}'}),this)" />`
    : `<div class="card-no-image ${size}" aria-hidden="true">${sourceEmoji(article.source)}</div>`;
  return `<article class="card" style="animation-delay:${delay}s" onclick="openArticle('${escHtml(article.link)}')" aria-label="${escHtml(article.title)}">
    ${imgHtml}
    <div class="card-body">
      <div class="card-meta">
        <span class="source-tag ${escHtml(article.source)}">${escHtml(article.sourceName)}</span>
        ${topicsHtml}
        <time class="card-time" datetime="${escHtml(article.pubDate)}">${timeAgo(article.pubDate)}</time>
      </div>
      <h2 class="card-title">${highlight(article.title)}</h2>
      ${article.description ? `<p class="card-desc">${highlight(article.description)}</p>` : ''}
    </div>
    <div class="card-footer">
      <span class="read-link" aria-hidden="true">Read full article â†’</span>
      <button class="card-bookmark ${saved?'saved':''}" onclick="toggleBookmark(event,'${escHtml(article.id)}')" aria-label="${saved?'Remove bookmark':'Save article'}" aria-pressed="${saved}">
        ${saved ? 'ğŸ”–' : 'ğŸ”–'}
      </button>
    </div>
  </article>`;
}

function buildListItem(article, idx) {
  const topicsHtml = (article.topics || []).slice(0, 2).map(t => `<span class="topic-tag">${escHtml(t)}</span>`).join('');
  return `<article class="list-item" onclick="openArticle('${escHtml(article.link)}')" aria-label="${escHtml(article.title)}">
    <div class="list-item-num" aria-hidden="true">${String(idx+1).padStart(2,'0')}</div>
    <div class="list-item-content">
      <div style="display:flex;align-items:center;gap:6px;margin-bottom:5px;flex-wrap:wrap;">
        <span class="source-tag ${escHtml(article.source)}">${escHtml(article.sourceName)}</span>
        ${topicsHtml}
        <time class="card-time" style="margin-left:auto" datetime="${escHtml(article.pubDate)}">${timeAgo(article.pubDate)}</time>
      </div>
      <h2 class="list-item-title">${highlight(article.title)}</h2>
      ${article.description ? `<p class="list-item-desc">${highlight(article.description)}</p>` : ''}
    </div>
  </article>`;
}

function renderSidebar() {
  // Sources
  const statsEl = document.getElementById('sourcesStats');
  if (statsEl) statsEl.innerHTML = state.sources.map(s => {
    const count = (state.grouped[s.id] || []).length;
    return `<div class="source-stat" onclick="setSource('${s.id}')" role="button" tabindex="0">
      <div class="source-stat-dot" style="background:${s.color}" aria-hidden="true"></div>
      <span class="source-stat-name">${escHtml(s.fullName)}</span>
      <span class="source-stat-count">${count}</span>
    </div>`;
  }).join('');

  // Topics cloud
  const topicsEl = document.getElementById('topicsCloud');
  if (topicsEl) topicsEl.innerHTML = state.topics.map(t => {
    const count = (state.topicGrouped[t] || []).length;
    const tabKey = Object.keys(TOPIC_MAP).find(k => TOPIC_MAP[k] === t) || '';
    const active = TOPIC_MAP[state.currentTab] === t;
    return `<span class="topic-chip ${active?'active':''}" onclick="setTopicTab('${tabKey}')" role="button" tabindex="0" aria-pressed="${active}">
      ${escHtml(t)} <span class="topic-chip-count">${count}</span>
    </span>`;
  }).join('');

  // PIB Ministry breakdown
  const pibMinCard = document.getElementById('pibMinistryCard');
  const pibMinList = document.getElementById('pibMinistryList');
  if (pibMinCard && pibMinList) {
    const pibMin = state.pibByMinistry || {};
    const pibMinKeys = Object.keys(pibMin).filter(k => pibMin[k].length > 0)
      .sort((a, b) => pibMin[b].length - pibMin[a].length);
    if (pibMinKeys.length > 0) {
      pibMinCard.style.display = 'block';
      pibMinList.innerHTML = pibMinKeys.slice(0, 15).map(m => {
        const safe = m.replace(/'/g, "\\'");
        return `<div class="source-stat" onclick="filterByMinistry('${safe}')" role="button" tabindex="0">
          <div class="source-stat-dot" style="background:var(--pib)" aria-hidden="true"></div>
          <span class="source-stat-name" style="font-size:0.73rem">${escHtml(m)}</span>
          <span class="source-stat-count">${pibMin[m].length}</span>
        </div>`;
      }).join('');
    } else {
      pibMinCard.style.display = 'none';
    }
  }

  // Init notif topics (once)
  const notifTopicsEl = document.getElementById('notifTopics');
  if (notifTopicsEl && !notifTopicsEl.children.length) {
    state.topics.forEach(t => {
      const active = state.notifSettings.notifTopics.includes(t);
      const span = document.createElement('span');
      span.className = `topic-chip ${active ? 'active' : ''}`;
      span.textContent = t;
      span.setAttribute('role', 'checkbox');
      span.setAttribute('aria-checked', String(active));
      span.setAttribute('tabindex', '0');
      span.onclick = () => {
        span.classList.toggle('active');
        const active2 = span.classList.contains('active');
        span.setAttribute('aria-checked', String(active2));
        const i = state.notifSettings.notifTopics.indexOf(t);
        if (i > -1) state.notifSettings.notifTopics.splice(i, 1);
        else state.notifSettings.notifTopics.push(t);
      };
      notifTopicsEl.appendChild(span);
    });
  }
}

function updateTicker() {
  const top = state.articles.slice(0, 20);
  const items = top.map(a =>
    `<span class="ticker-item" onclick="openArticle('${escHtml(a.link)}')" tabindex="-1">${escHtml(a.title)}<span class="ticker-sep" aria-hidden="true">  â—†  </span></span>`
  ).join('');
  const track = document.getElementById('tickerTrack');
  if (track) track.innerHTML = items + items;
}

function updateLastUpdate() {
  if (!state.lastUpdated) return;
  document.getElementById('lastUpdateText').textContent = 'â†» ' + timeAgo(state.lastUpdated);
}

// â”€â”€ SKELETON â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showSkeleton() {
  const container = document.getElementById('articlesContainer');
  if (container) container.innerHTML = `<div class="news-grid">
    ${Array.from({length:6}).map(() => `
      <div class="skeleton-card" aria-hidden="true">
        <div class="skeleton sk-img"></div>
        <div class="sk-body">
          <div class="skeleton sk-line" style="width:40%"></div>
          <div class="skeleton sk-title"></div>
          <div class="skeleton sk-desc1"></div>
          <div class="skeleton sk-desc2"></div>
        </div>
      </div>`).join('')}
  </div>`;
  const heroGrid = document.getElementById('heroGrid');
  if (heroGrid) heroGrid.innerHTML = `
    <div class="skeleton-card" aria-hidden="true"><div class="skeleton" style="height:200px"></div><div class="sk-body"><div class="skeleton sk-title"></div><div class="skeleton sk-desc1"></div></div></div>
    <div class="skeleton-card" aria-hidden="true"><div class="skeleton sk-img"></div><div class="sk-body"><div class="skeleton sk-title"></div></div></div>
    <div class="skeleton-card" aria-hidden="true"><div class="skeleton sk-img"></div><div class="sk-body"><div class="skeleton sk-title"></div></div></div>`;
}

// â”€â”€ EVENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.querySelectorAll('.nav-tab').forEach(tab => {
  tab.addEventListener('click', () => {
    state.currentTab = tab.dataset.tab;
    document.querySelectorAll('.nav-tab').forEach(t => {
      t.classList.toggle('active', t === tab);
      t.setAttribute('aria-selected', String(t === tab));
    });
    renderAll();
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });
  // Keyboard support
  tab.addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); tab.click(); } });
});

document.querySelectorAll('.source-pill').forEach(pill => {
  pill.addEventListener('click', () => {
    state.currentSource = pill.dataset.src;
    document.querySelectorAll('.source-pill').forEach(p => {
      p.classList.toggle('active', p === pill);
      p.setAttribute('aria-pressed', String(p === pill));
    });
    renderAll();
  });
});

// Desktop search
const searchInput = document.getElementById('searchInput');
if (searchInput) searchInput.addEventListener('input', e => {
  state.searchQuery = e.target.value.trim();
  debounce(() => renderAll(), 280)();
});

// Refresh buttons (header + bar)
document.getElementById('btnRefresh').addEventListener('click', doRefresh);
const btnRefreshBar = document.getElementById('btnRefreshBar');
if (btnRefreshBar) btnRefreshBar.addEventListener('click', doRefresh);
function doRefresh() {
  document.querySelectorAll('#btnRefresh, #btnRefreshBar').forEach(b => b.classList.add('spinning'));
  fetchNews().finally(() => document.querySelectorAll('#btnRefresh, #btnRefreshBar').forEach(b => b.classList.remove('spinning')));
}

// Notification panel
document.getElementById('btnNotif').addEventListener('click', () => {
  const panel = document.getElementById('notifPanel');
  const open = !panel.classList.contains('open');
  panel.classList.toggle('open', open);
  document.getElementById('btnNotif').setAttribute('aria-expanded', String(open));
  document.getElementById('bookmarksPanel').classList.remove('open');
});
document.getElementById('notifClose').addEventListener('click', () => {
  document.getElementById('notifPanel').classList.remove('open');
  document.getElementById('btnNotif').setAttribute('aria-expanded', 'false');
});

// Bookmarks
document.getElementById('btnBookmarks').addEventListener('click', toggleBookmarks);

// View toggle
document.getElementById('viewGrid').addEventListener('click', () => {
  state.viewMode = 'grid';
  document.getElementById('viewGrid').classList.add('active');
  document.getElementById('viewGrid').setAttribute('aria-pressed', 'true');
  document.getElementById('viewList').classList.remove('active');
  document.getElementById('viewList').setAttribute('aria-pressed', 'false');
  renderArticles();
});
document.getElementById('viewList').addEventListener('click', () => {
  state.viewMode = 'list';
  document.getElementById('viewList').classList.add('active');
  document.getElementById('viewList').setAttribute('aria-pressed', 'true');
  document.getElementById('viewGrid').classList.remove('active');
  document.getElementById('viewGrid').setAttribute('aria-pressed', 'false');
  renderArticles();
});

// Interval buttons
document.getElementById('intervalBtns').addEventListener('click', e => {
  if (e.target.classList.contains('interval-btn')) {
    document.querySelectorAll('.interval-btn').forEach(b => b.classList.remove('active'));
    e.target.classList.add('active');
    state.notifSettings.intervalMins = parseInt(e.target.dataset.mins);
    scheduleRefresh();
  }
});

// Close panels on outside click
document.addEventListener('click', e => {
  if (!e.target.closest('.notif-panel') && !e.target.closest('#btnNotif')) {
    document.getElementById('notifPanel').classList.remove('open');
    document.getElementById('btnNotif').setAttribute('aria-expanded', 'false');
  }
  if (!e.target.closest('.bookmarks-panel') && !e.target.closest('#btnBookmarks'))
    document.getElementById('bookmarksPanel').classList.remove('open');
  if (!e.target.closest('.mobile-search-overlay') && !e.target.closest('#btnMobileSearch'))
    closeMobileSearch();
});

// Escape key closes panels
document.addEventListener('keydown', e => {
  if (e.key === 'Escape') { closePanels(); closeMobileSearch(); }
});

// â”€â”€ MOBILE SEARCH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('btnMobileSearch').addEventListener('click', () => {
  const overlay = document.getElementById('mobileSearchOverlay');
  overlay.classList.add('open');
  overlay.style.display = 'flex';
  setTimeout(() => document.getElementById('mobileSearchInput').focus(), 100);
});

document.getElementById('mobileSearchCancel').addEventListener('click', closeMobileSearch);

document.getElementById('mobileSearchInput').addEventListener('input', e => {
  state.searchQuery = e.target.value.trim();
  if (searchInput) searchInput.value = state.searchQuery;
  debounce(() => renderAll(), 280)();
});

function closeMobileSearch() {
  const overlay = document.getElementById('mobileSearchOverlay');
  overlay.classList.remove('open');
  overlay.style.display = 'none';
}

function doMobileSearch(term) {
  document.getElementById('mobileSearchInput').value = term;
  state.searchQuery = term;
  if (searchInput) searchInput.value = term;
  renderAll();
  closeMobileSearch();
  showToast('ğŸ” Showing results for "' + term + '"');
}

// â”€â”€ BOOKMARKS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleBookmark(event, articleId) {
  event.stopPropagation();
  const article = state.articles.find(a => a.id === articleId);
  if (!article) return;
  const idx = state.bookmarks.findIndex(b => b.id === articleId);
  if (idx > -1) { state.bookmarks.splice(idx, 1); showToast('ğŸ—‘ Removed from saved'); }
  else          { state.bookmarks.push(article);   showToast('ğŸ”– Article saved!'); }
  localStorage.setItem('upsc_bookmarks', JSON.stringify(state.bookmarks));
  updateBookmarkBadge(); renderArticles(); renderBookmarksPanel(); updateCounts();
}

function toggleBookmarks() {
  const panel = document.getElementById('bookmarksPanel');
  panel.classList.toggle('open');
  document.getElementById('notifPanel').classList.remove('open');
  if (panel.classList.contains('open')) renderBookmarksPanel();
}

function renderBookmarksPanel() {
  const el = document.getElementById('bookmarksList');
  if (!el) return;
  if (!state.bookmarks.length) {
    el.innerHTML = '<div class="empty-state" style="padding:28px 10px"><div class="icon" aria-hidden="true">ğŸ”–</div><h3>No saved articles</h3><p>Bookmark articles to read later.</p></div>';
    return;
  }
  el.innerHTML = state.bookmarks.map(a => `
    <div style="padding:10px 2px;border-bottom:1px solid var(--border);cursor:pointer" onclick="openArticle('${escHtml(a.link)}')">
      <div style="display:flex;align-items:center;gap:6px;margin-bottom:4px;">
        <span class="source-tag ${escHtml(a.source)}">${escHtml(a.sourceName)}</span>
        <time style="font-size:0.62rem;color:var(--text3);margin-left:auto" datetime="${escHtml(a.pubDate)}">${timeAgo(a.pubDate)}</time>
        <button onclick="toggleBookmark(event,'${escHtml(a.id)}')" style="font-size:0.8rem;color:var(--red);padding:4px;touch-action:manipulation" aria-label="Remove bookmark">âœ•</button>
      </div>
      <div style="font-family:var(--font-display);font-size:0.9rem;font-weight:600;line-height:1.4;color:var(--text)">${escHtml(a.title)}</div>
    </div>`).join('');
}

function updateBookmarkBadge() {
  const badge = document.getElementById('bookmarkBadge');
  if (badge) badge.style.display = state.bookmarks.length > 0 ? 'block' : 'none';
}

// â”€â”€ NOTIFICATIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleSetting(key) {
  state.notifSettings[key] = !state.notifSettings[key];
  const id = `toggle${key.charAt(0).toUpperCase() + key.slice(1)}`;
  const el = document.getElementById(id);
  if (el) {
    el.classList.toggle('on', state.notifSettings[key]);
    el.setAttribute('aria-checked', String(state.notifSettings[key]));
  }
  if (key === 'notif' && state.notifSettings.notif) requestNotifPermission();
  if (key === 'autoRefresh') {
    if (state.notifSettings.autoRefresh) scheduleRefresh();
    else { clearTimeout(state.refreshTimer); document.getElementById('sidebarCountdown').textContent = 'Paused'; }
  }
}

function requestNotifPermission() {
  if (!('Notification' in window)) {
    showToast('âš  Notifications not supported'); state.notifSettings.notif = false;
    document.getElementById('toggleNotif').classList.remove('on'); return;
  }
  Notification.requestPermission().then(perm => {
    if (perm === 'granted') {
      showToast('âœ… Notifications enabled!');
      new Notification('UPSC Samachar', { body: 'You will now receive UPSC news alerts.', icon: '/icon-192.png' });
    } else {
      state.notifSettings.notif = false;
      document.getElementById('toggleNotif').classList.remove('on');
      showToast('âš  Notification permission denied');
    }
  });
}

function checkForNewArticles() {
  if (!state.notifSettings.notif || Notification.permission !== 'granted') return;
  const fresh = state.articles.filter(a => (Date.now() - new Date(a.pubDate)) / 60000 < state.notifSettings.intervalMins);
  if (fresh.length > 0)
    new Notification('UPSC Samachar', { body: `${fresh.length} new UPSC articles just fetched!`, icon: '/icon-192.png' });
}

function saveNotifSettings() {
  localStorage.setItem('upsc_notif', JSON.stringify(state.notifSettings));
  document.getElementById('notifPanel').classList.remove('open');
  showToast('âœ… Settings saved!');
  if (state.notifSettings.autoRefresh) scheduleRefresh();
}

function applyNotifSettings() {
  const toggleNotif = document.getElementById('toggleNotif');
  const toggleAR    = document.getElementById('toggleAutoRefresh');
  if (toggleNotif) { toggleNotif.classList.toggle('on', state.notifSettings.notif); toggleNotif.setAttribute('aria-checked', String(state.notifSettings.notif)); }
  if (toggleAR)    { toggleAR.classList.toggle('on', state.notifSettings.autoRefresh); toggleAR.setAttribute('aria-checked', String(state.notifSettings.autoRefresh)); }
  document.querySelectorAll('.interval-btn').forEach(btn =>
    btn.classList.toggle('active', parseInt(btn.dataset.mins) === state.notifSettings.intervalMins)
  );
}

// â”€â”€ AUTO-REFRESH & COUNTDOWN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function scheduleRefresh() {
  clearTimeout(state.refreshTimer);
  if (!state.notifSettings.autoRefresh) return;
  const ms = state.notifSettings.intervalMins * 60 * 1000;
  state.nextRefreshAt = Date.now() + ms;
  state.refreshTimer = setTimeout(() => fetchNews(), ms);
  updateCountdown();
}

function updateCountdown() {
  if (!state.notifSettings.autoRefresh) return;
  const remaining = Math.max(0, state.nextRefreshAt - Date.now());
  const mins = Math.floor(remaining / 60000);
  const secs = Math.floor((remaining % 60000) / 1000);
  const cd = document.getElementById('sidebarCountdown');
  const nt = document.getElementById('sidebarNextTime');
  if (cd) cd.textContent = `${String(mins).padStart(2,'0')}:${String(secs).padStart(2,'0')}`;
  if (nt) nt.textContent = remaining > 0
    ? `Refreshes at ${new Date(state.nextRefreshAt).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}`
    : 'Refreshingâ€¦';
  if (remaining > 0) setTimeout(updateCountdown, 1000);
}

// â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openArticle(url) { if (url && url !== '#') window.open(url, '_blank', 'noopener,noreferrer'); }

function setSource(src) {
  state.currentSource = src;
  document.querySelectorAll('.source-pill').forEach(p => {
    p.classList.toggle('active', p.dataset.src === src);
    p.setAttribute('aria-pressed', String(p.dataset.src === src));
  });
  renderAll();
}

function setTopicTab(key) {
  state.currentTab = key || 'all';
  document.querySelectorAll('.nav-tab').forEach(t => {
    t.classList.toggle('active', t.dataset.tab === state.currentTab);
    t.setAttribute('aria-selected', String(t.dataset.tab === state.currentTab));
  });
  renderAll();
}

function setMobileTab(tab, el) {
  state.currentTab = tab;
  document.querySelectorAll('.nav-tab').forEach(t => {
    t.classList.toggle('active', t.dataset.tab === tab);
    t.setAttribute('aria-selected', String(t.dataset.tab === tab));
  });
  document.querySelectorAll('.mobile-nav-item').forEach(i => i.classList.remove('active'));
  if (el) el.classList.add('active');
  renderAll();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function filterByMinistry(ministry) {
  state.currentSource = 'pib';
  document.querySelectorAll('.source-pill').forEach(p => {
    p.classList.toggle('active', p.dataset.src === 'pib');
    p.setAttribute('aria-pressed', String(p.dataset.src === 'pib'));
  });
  state.searchQuery = ministry;
  const si = document.getElementById('searchInput');
  if (si) si.value = ministry;
  renderAll();
  showToast('ğŸ›ï¸ ' + ministry);
}

function closePanels() {
  document.getElementById('notifPanel').classList.remove('open');
  document.getElementById('bookmarksPanel').classList.remove('open');
  document.getElementById('btnNotif').setAttribute('aria-expanded', 'false');
}

function sourceEmoji(src) {
  return { pib:'ğŸ›ï¸', hindu:'ğŸ“°', indianexpress:'ğŸ“‹', et:'ğŸ’¹' }[src] || 'ğŸ“„';
}

function escHtml(str) {
  return (str||'').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}

function timeAgo(dateStr) {
  if (!dateStr) return '';
  const d = (Date.now() - new Date(dateStr)) / 1000;
  if (d < 60) return 'just now';
  if (d < 3600) return Math.floor(d/60) + 'm ago';
  if (d < 86400) return Math.floor(d/3600) + 'h ago';
  return Math.floor(d/86400) + 'd ago';
}

function highlight(text) {
  if (!state.searchQuery || !text) return escHtml(text);
  try {
    const q = state.searchQuery.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    return escHtml(text).replace(new RegExp(`(${q})`, 'gi'), '<mark class="highlight">$1</mark>');
  } catch { return escHtml(text); }
}

function setProgress(pct) {
  const bar = document.getElementById('progress-bar');
  bar.style.width = pct + '%';
  if (pct >= 100) setTimeout(() => { bar.style.width = '0'; bar.style.transition = 'none'; setTimeout(() => bar.style.transition = '', 50); }, 700);
  else bar.style.transition = 'width 0.3s ease';
}

let debounceTimer;
function debounce(fn, ms) {
  return () => { clearTimeout(debounceTimer); debounceTimer = setTimeout(fn, ms); };
}

function showToast(msg) {
  const c = document.getElementById('toastContainer');
  const t = document.createElement('div');
  t.className = 'toast'; t.textContent = msg;
  c.appendChild(t);
  setTimeout(() => t.remove(), 3200);
}

// â”€â”€ DEMO DATA (fallback) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderDemoData() {
  const now = Date.now();
  state.articles = [
    { id:'d1', title:'Union Cabinet approves new National Education Policy reforms for higher education', description:'The Cabinet chaired by PM has approved significant amendments to the NEP framework for higher education institutions across the country, expanding digital access.', link:'#', pubDate:new Date(now).toISOString(), source:'pib', sourceName:'PIB', topics:['Polity & Governance','Social Issues'], imageUrl:'' },
    { id:'d2', title:'RBI holds repo rate steady at 6.5% amid sticky inflation concerns', description:'The Monetary Policy Committee voted unanimously to maintain status quo citing sticky core inflation and global uncertainty in its latest bimonthly meeting.', link:'#', pubDate:new Date(now-3600000).toISOString(), source:'et', sourceName:'Economic Times', topics:['Economy'], imageUrl:'' },
    { id:'d3', title:'India logs record merchandise exports crossing $92 billion mark', description:'Commerce Ministry data shows India achieved its highest-ever annual merchandise exports crossing the 90 billion dollar mark for Q1, driven by engineering goods.', link:'#', pubDate:new Date(now-7200000).toISOString(), source:'hindu', sourceName:'The Hindu', topics:['Economy','International Relations'], imageUrl:'' },
    { id:'d4', title:'Supreme Court upholds validity of forest conservation amendment act', description:'A five-judge bench ruled that parliament was within its powers to amend the Forest Conservation Act 1980, expanding its scope to include private forests.', link:'#', pubDate:new Date(now-10800000).toISOString(), source:'indianexpress', sourceName:'Indian Express', topics:['Polity & Governance','Environment & Ecology'], imageUrl:'' },
    { id:'d5', title:'ISRO successfully launches EOS-09 earth observation satellite via PSLV-C61', description:'PSLV-C61 carried the 1696 kg remote sensing satellite to sun-synchronous orbit providing high-resolution imagery for agriculture and disaster management.', link:'#', pubDate:new Date(now-14400000).toISOString(), source:'pib', sourceName:'PIB', topics:['Science & Technology'], imageUrl:'' },
    { id:'d6', title:'India-Bangladesh sign new water-sharing framework for Teesta river basin', description:'The bilateral agreement was inked during the Foreign Ministers meeting in Dhaka marking a diplomatic breakthrough after years of negotiations.', link:'#', pubDate:new Date(now-18000000).toISOString(), source:'hindu', sourceName:'The Hindu', topics:['International Relations'], imageUrl:'' },
  ];
  state.grouped = { pib:[state.articles[0],state.articles[4]], hindu:[state.articles[2],state.articles[5]], indianexpress:[state.articles[3]], et:[state.articles[1]] };
  state.topicGrouped = { 'Polity & Governance':[state.articles[0],state.articles[3]], 'Economy':[state.articles[1],state.articles[2]], 'Environment & Ecology':[state.articles[3]], 'Science & Technology':[state.articles[4]], 'International Relations':[state.articles[2],state.articles[5]], 'Social Issues':[state.articles[0]] };
  state.sources = [{id:'pib',name:'PIB',fullName:'Press Information Bureau',color:'#F97316'},{id:'hindu',name:'The Hindu',fullName:'The Hindu',color:'#DC2626'},{id:'indianexpress',name:'Indian Express',fullName:'The Indian Express',color:'#2563EB'},{id:'et',name:'Economic Times',fullName:'The Economic Times',color:'#059669'}];
  state.topics = ['Polity & Governance','Economy','Environment & Ecology','Science & Technology','International Relations','Social Issues','Defence & Security','Infrastructure & Development'];
  state.lastUpdated = new Date().toISOString(); state.total = state.articles.length;
  renderAll(); updateTicker();
}

// â”€â”€ SERVICE WORKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => navigator.serviceWorker.register('/sw.js').catch(() => {}));
}

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
applyNotifSettings();
updateBookmarkBadge();
fetchNews();
</script>
</body>
</html>
